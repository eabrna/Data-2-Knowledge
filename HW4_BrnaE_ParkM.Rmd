---
title: "Homework 04"
author: "Washington, George; Jefferson, Thomas; Madison, James" # <--- Please change to your names here, format: "LastName, FirstName"
date: 'Due: Wed Oct 02 | 11:59pm'
output:
  html_document:
    toc: true
    toc_float: true
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---

**APMA 3150 \| Fall 2024 \| University of Virginia**

***"On my honor, I pledge that I have neither given nor received unauthorized aid on this assignment." - The author of this RMarkdown file.***

<!--- Solution Region --->

```{css solution-region, echo=FALSE}
.solution {
    background-color: #232D4B10;
    border-style: solid;
    border-color: #232D4B;
    padding: .5em;
    margin: 20px
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

# [Problems]{style="color:#FF7F50"}

This homework problem set covers correlation & smoothing spline, which will be tested in your exam 1. Part I problems will use `fat` dataset, and Part II problems will use `Animals` dataset. Both are in Verzani's textbook package `UsingR`. **In the problems below, any plot of Y vs X will have the vertical axis as Y-axis and horizontal axis as X-axis.**
```{r message=FALSE}
library(UsingR)
```

## Part I

### Problem 1

Graph 4 plots in 2 rows and 2 columns:

(i) Plot `neck` vs `wrist` for individuals of age larger than 20 and less than 30;

(ii) Plot `neck` vs `wrist` for individuals of age larger than 50;

(iii) Plot `neck` vs `height` for individuals of age larger than 20 and less than 30; 

(iv) Plot `neck` vs `height` for individuals of age larger than 50.

#### {.solution}

```{r}
attach(fat)
par(mfrow = c(2, 2))

fat_subset1 <- subset(fat, age > 20 & age < 30)
fat_subset2 <- subset(fat, age > 50)

# i
plot(fat_subset1$wrist, fat_subset1$neck, xlab = "Wrist", ylab = "Neck", main = "Neck vs Wrist (Age 20-30)")

# ii
plot(fat_subset2$wrist, fat_subset2$neck, xlab = "Wrist", ylab = "Neck", main = "Neck vs Wrist (Age > 50)")

# iii
plot(fat_subset1$height, fat_subset1$neck, xlab = "Height", ylab = "Neck", main = "Neck vs Height (Age 20-30)")

# iv
plot(fat_subset2$height, fat_subset2$neck, xlab = "Height", ylab = "Neck", main = "Neck vs Height (Age > 50)")



```

### Problem 2

Find Pearson, Spearman, Kendall correlations for `neck` and `wrist`, and for `height` and `wrist`.

#### {.solution}
```{r}
# Type your code here.






```

### Problem 3

Find correlation coefficients for `knee` and `wrist` with the three methods: Pearson, Spearman, Kendall.

#### {.solution}
```{r}
# Type your code here.



```

### Problem 4

Plot `wrist` vs `knee` with the regression line (in red) and the smoothing spline (in blue) with 40 degrees of freedom.

#### {.solution}
```{r}
# Type your code here.



```

### Problem 5

Find the exact degrees of freedom for the best-fitted smoothing spline model with 40 degrees of freedom.

#### {.solution}
```{r}
# Type your code here.



```

## Part II

### Problem 1 (1)

Find correlation between `body` and `brain`.

#### {.solution}
```{r}
attach(Animals)
# Type your code here.

```

### Problem 1 (2)

Plot `brain` vs `body` with the linear regression line and a smoothing spline with `df=5`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 1 (3)

Print the intercept and slope for the regression line, and exact degrees of freedom for the best-fitted smoothing spline with `df=5`.

#### {.solution}
```{r}
# Type your code here.


```

### Problem 2 (1)

Use the cross product defined as `cross_prod <- (body-mean(body))*(brain-mean(brain))` to create a bar plot of  `cross_prod` as vertical bars.

#### {.solution}
```{r}
# Type your code here.


```

### Problem 2 (2)

List Animals with a negative cross product (only first 6).

#### {.solution}
```{r}
# Type your code here.

```

### Problem 2 (3)

List Animals with a positive cross product (only first 6).

#### {.solution}
```{r}
# Type your code here.

```

### Problem 2 (4)

Now plot two bar plots, the first one for negative cross products, the second one for positive cross products.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 3 (1)

Rank the variable `body` and name the rank vector as `rbody`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 3 (2)

Rank the variable `brain` and name the rank vector as `rbrain`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 3 (3)

Plot `body` vs `brain` and `rbody` vs `rbrain` in two scatter plots (left plot for `body` and `brain`, right plot for `rbody` and `rbrain`).

#### {.solution}
```{r}
# Type your code here.

```

### Problem 3 (4)

Plot the two bar plots of the cross products: on left `body` and `brain`, on the right `rbody` and `rbrain`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 4 (1)

Find the correlation coefficients for `rbody` and `rbrain`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 4 (2)

Plot `rbody` vs `rbrain` with the regression line, and smoothing spline with `df=5`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 5 (1)

Let's do log transformation of data (see Page 120 Verzani).
```{r}
lbody <- log(body)
lbrain <- log(brain)
```

Do a bar plot of the cross product of `lbody` and `lbrain`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 5 (2)

Plot `lbody` vs `lbrain`, with regression line and smoothing spline with `df=5`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 5 (3)

Find all the correlation coefficients for `lbrain` and `lbody`.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 6 (1)

Lastly, we run correlation tests: for `brain` and `body`, run the correlation test and print the p-value.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 6 (2)

For `rbrain` and `rbody`, run the correlation test and print the p-value.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 6 (3)

For `lbrain` and `lbody`, run the correlation test and print the p-value.

#### {.solution}
```{r}
# Type your code here.

```

### Problem 6 (4)

Explain why the second and the third are equal to the corresponding ones in `rbody`-`rbrain` and `lbody-lbrain`.

#### {.solution}
Your answer:
