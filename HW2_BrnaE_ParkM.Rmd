---
title: "Homework 2"
author: "Brna, Elliot; Park, Mia" # <--- Please change to your names here, format: "LastName, FirstName"
date: 'Due: Wed Sep 11'p
{:?}|| 11:59pm'
output:
  html_document:
    toc: true
    toc_float: true
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---

**APMA 3150 \| Fall 2024 \| University of Virginia**

***"On my honor, I pledge that I have neither given nor received unauthorized aid on this assignment." - The author of this RMarkdown file.***

<!--- Solution Region --->

```{css solution-region, echo=FALSE}
.solution {
    backgroud-color: 232D4B10;
    border-style: solid;
    border-color: 232D4B;
    padding: .5em;
    margin: 20px
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## [Group Work Guideline]{style="color:#0066CC"}

### Overall objectives
- Teach and learn from your peers (leverage opportunity offered by our physical presence).
- Improve learning/grade of all your teammates.

### Specific goals for teamwork sessions (what)
- Every team member should gain a good understanding of each problem and its solution.
- Discuss any thoughts triggered by problems that can enhance learning.
- Submit one homework solution per team.

### Methods (how)
1. Meet each other: names, year in program, degree, hometown, anything else of interest; Learn names.
2. Choose scribe (to write the team solution) and each team member should take a turn as scribe.
3. Choose moderator (cut off discussions/watch time); each team member should take a turn as moderator.
4. Pass individual homework solutions in a circle, so that each team member has read other team members’ homework solutions and is thus aware of the starting set from which your team discussions will follow.
5. Make two passes through all problems of the assignment:
    + Pass 1: Focus on deriving answer for the scribe to write into the team homework submission.
    + Pass 2: Go back through each problem and discuss any thoughts triggered by the problem (e.g., discuss assumptions required for formulas and what happens if they do not hold; this will enhance conceptual learning).
6. While executing Pass 1, let’s say for a problem, two members have one answer, and the third member (MVP) has a different answer. First determine which answer is correct. Let’s say the 2-member answer was correct. Do not have just one of the 2 members explain the steps taken to reach the answer to the MVP while the other two members engage in other activities. If you listen to your peer, you may find her/his reasoning to be different from yours, which improves your own understanding. Or you may find your way of reasoning to be easier for the MVP to follow. Therefore stay engaged.
7. One conversation at a time. No side bars. Stay fully engaged in the team conversation.
8. No multi-tasking (if a discussion is running too long, lean in, and bring conversation to an end).

### Motivation (why)
- Increased learning occurs when talking about what you have learned, and through teaching.
- Importance placed on teamwork and communications skills by companies.

## [Problems]{style="color:#FF7F50"}

We need to first load Verzani's textbook packages `MASS`, `UsingR`, our course package `APMA3150` in our working environment. 
```{r message=FALSE}
library(MASS)
library(UsingR)
library(APMA3150)
```

### 1. Rivers in North America (Part 1). URIS Problem 2.42. 
The data set rivers contains the lengths (in miles) of 141 major rivers in North America.
1. What proportion are less than 500 miles long?
2. What proportion are less than the mean length?
3. What is the 0.75 quantile?

#### {solution}
```{r}
# Type your solution here.
rivers = sort(rivers)

#1
i = 0
for (n in rivers) {
  if (n < 500)
    i = i + 1
}
p1 = i/141
print(paste('The proportion of rivers less than 500 miles long is', p1))

#2 
j = 0
mean = mean(rivers)
for (n in rivers) {
  if (n < mean)
    j = j + 1
}
p2 = j/141
print(paste('The proportion of rivers less than 500 miles long is', p2))

#3
q3 = quantile(rivers, 0.75)
print(paste('The 0.75 quantile of rivers is', q3))

```
Write your conclusion here...

### 2. Rivers in North America (Part 2). URIS Problem 2.44.
Compare values of the mean, median, and 25%-trimmed mean on the built-in rivers data set. Is there a big difference among the three?
*Also provide the minimum, 1st & 3rd quartiles and maximum values. Plot a histogram.

#### {solution}
```{r}
# Type your solution here...
river_stats = summary(rivers)

river_stats["Mean"]
river_stats["Median"]

trimmed_mean = mean(rivers, trim = .25)
print('25%-trimmed mean'); trimmed_mean

river_stats["Min."]

river_stats["1st Qu."]

river_stats["3rd Qu."]

river_stats["Max."]

hist(rivers)


```
Write your conclusion here...
### 3. Compensation for CEOs. URIS Problem 2.54.
Sometimes a data set is so skewed that it can help if we transform the data prior to looking at it. A common transformation for long-tailed data sets is to take the logarithm of the data. 
For example, the exec.pay (UsingR) data set is highly skewed. Look at histograms before and after taking a logarithmic transform. Which is better at showing the data and why? (You can transform with the command log(1 + exec.pay, 1).) 
Find the median and the mean for the transformed data. How do they correspond to the median and mean f the untransformed data?

*Use command par(mfrow = c(1,2)) to create two sub-graphs in one graph.
#### {solution}
```{r}
# Type your solution here...
```
Write your conclusion here...

### 4.Speed of light. URIS Problem 2.56.
The Michelson (HistData) data set records 100 measurements by Michelson of the speed of light (in the variable velocity). Make a quantile-normal graph and discuss if the graphic shows the points falling on a straight line.

#### {solution}
```{r}
qqnorm(Michelson$velocity, main="Q-Q plot & line for velocity")
qqline(Michelson$velocity, col="blue")
```
The Q-Q plot for variable velocity is relatively linear with increasing deviation as the absolute value of the theoretical quantiles increases.The data for speed of light will moderately resemble a normal distribution.

### 5. Car models. URIS Problem 2.59.
In the Cars93 (MASS) data set, which is more skewed, the Price or MPG.highway variable?

*Please include two graphs: each should contain two sub-
graphs; Graph 1: histograms; Graph 2: Q-Q norm plots. To answer the question which is more skewed, install and load e1071 library package and give Type-1 skewness values in your
answers

*skewness(x, type = 1)
#### {solution}
```{r}
# Type your solution here...
install.packages('e1071')
library(e1071)


```
Write your conclusion here...


### 6. Mode function. URIS Problem 2.60.
Write a function to find the most common value of a data vector, e.g., the “mode.”

*example on code in book, just need to functionalize it (p. 59 according to book, 79 actually)

#### {solution}
```{r}
# Type your solution here...


```
Write your conclusion here...

### 7. Split function. URIS Problem 3.7.
The split function will coerce its second argument to a factor then split. This is useful if the grouping variable is stored as a numeric value. Verify this by splitting the mpg variable in the mtcars data set by the cyl variable.

#### {solution}
```{r}
# Type your solution here...
split(mtcars$mpg, mtcars$cyl)

```
Write your conclusion here...

### 8. Foster and biological twins. URIS Problem 3.10.
For the data set twins (UsingR) make a boxplot of the Foster and Biological variables. Do they appear to have the same spread? The same
center?

* Please include the boxplots as well; it should be side-by-side boxplots in one graph.

#### {solution}
```{r}
# Type your solution here...
```
Write your conclusion here...

### 9. Normal body temperature. URIS Problem 3.12.
The data set normtemp (UsingR) contains normal body temperature measurements for 130 healthy individuals recorded in the variable temperature. The variable gender is 1 for a male subject and 2 for a female subject. Break the data up by gender and create side-by-side boxplots. Does it appear that males and females have similar normal body temperatures?

#### {solution}
```{r}
# Type your solution here...
gender_split = split(normtemp$temperature, normtemp$gender);
names(gender_split) = c("Male", "Female")

boxplot(gender_split, main="Normal Body Temperature Split by Gender")
```
Write your conclusion here...
While males and females do have similar normal body temperatures, generally female normal body temperatures are higher. 
